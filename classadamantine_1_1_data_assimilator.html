<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>adamantine: adamantine::DataAssimilator Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">adamantine
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceadamantine.html">adamantine</a></li><li class="navelem"><a class="el" href="classadamantine_1_1_data_assimilator.html">DataAssimilator</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classadamantine_1_1_data_assimilator-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">adamantine::DataAssimilator Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="_data_assimilator_8hh_source.html">DataAssimilator.hh</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a9aca6e1413a227d29e89faa45a8006f0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#a9aca6e1413a227d29e89faa45a8006f0">DataAssimilator</a> (MPI_Comm const &amp;global_communicator, MPI_Comm const &amp;local_communicator, int my_color, boost::property_tree::ptree const &amp;database)</td></tr>
<tr class="separator:a9aca6e1413a227d29e89faa45a8006f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab90c04d7eb24c9202e84409109146143"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#ab90c04d7eb24c9202e84409109146143">update_ensemble</a> (std::vector&lt; dealii::LA::distributed::BlockVector&lt; double &gt;&gt; &amp;augmented_state_ensemble, std::vector&lt; double &gt; const &amp;expt_data, dealii::SparseMatrix&lt; double &gt; const &amp;R)</td></tr>
<tr class="separator:ab90c04d7eb24c9202e84409109146143"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c09078d680adc5d2a791a570bb5a7ac"><td class="memTemplParams" colspan="2">template&lt;int dim&gt; </td></tr>
<tr class="memitem:a6c09078d680adc5d2a791a570bb5a7ac"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#a6c09078d680adc5d2a791a570bb5a7ac">update_dof_mapping</a> (std::pair&lt; std::vector&lt; int &gt;, std::vector&lt; int &gt;&gt; const &amp;expt_to_dof_mapping)</td></tr>
<tr class="separator:a6c09078d680adc5d2a791a570bb5a7ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa589f4a2068eddc12fbb1408ffec04b7"><td class="memTemplParams" colspan="2">template&lt;int dim&gt; </td></tr>
<tr class="memitem:aa589f4a2068eddc12fbb1408ffec04b7"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#aa589f4a2068eddc12fbb1408ffec04b7">update_covariance_sparsity_pattern</a> (dealii::DoFHandler&lt; dim &gt; const &amp;dof_handler, const unsigned int parameter_size)</td></tr>
<tr class="separator:aa589f4a2068eddc12fbb1408ffec04b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:aa0515b812dcfc0c4c14789d6c7cd0b4c"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#aa0515b812dcfc0c4c14789d6c7cd0b4c">block_size_type</a> = dealii::LA::distributed::BlockVector&lt; double &gt;::size_type</td></tr>
<tr class="separator:aa0515b812dcfc0c4c14789d6c7cd0b4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a85dc10ab67036ce6c85429dd1cf2fce9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#a85dc10ab67036ce6c85429dd1cf2fce9">gather_ensemble_members</a> (std::vector&lt; dealii::LA::distributed::BlockVector&lt; double &gt;&gt; &amp;augmented_state_ensemble, std::vector&lt; dealii::LA::distributed::BlockVector&lt; double &gt;&gt; &amp;global_augmented_state_ensemble, std::vector&lt; unsigned int &gt; &amp;local_n_ensemble_members, std::vector&lt; <a class="el" href="classadamantine_1_1_data_assimilator.html#aa0515b812dcfc0c4c14789d6c7cd0b4c">block_size_type</a> &gt; &amp;block_sizes)</td></tr>
<tr class="separator:a85dc10ab67036ce6c85429dd1cf2fce9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac27d0c63d7e8b2a70bd29d29e6ae8a10"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#ac27d0c63d7e8b2a70bd29d29e6ae8a10">scatter_ensemble_members</a> (std::vector&lt; dealii::LA::distributed::BlockVector&lt; double &gt;&gt; &amp;augmented_state_ensemble, std::vector&lt; dealii::LA::distributed::BlockVector&lt; double &gt;&gt; const &amp;global_augmented_state_ensemble, std::vector&lt; unsigned int &gt; const &amp;local_n_ensemble_members, std::vector&lt; <a class="el" href="classadamantine_1_1_data_assimilator.html#aa0515b812dcfc0c4c14789d6c7cd0b4c">block_size_type</a> &gt; const &amp;block_sizes)</td></tr>
<tr class="separator:ac27d0c63d7e8b2a70bd29d29e6ae8a10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a405e8d43091eca88e94898eb885313c3"><td class="memItemLeft" align="right" valign="top">std::vector&lt; dealii::LA::distributed::BlockVector&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#a405e8d43091eca88e94898eb885313c3">apply_kalman_gain</a> (std::vector&lt; dealii::LA::distributed::BlockVector&lt; double &gt;&gt; &amp;augmented_state_ensemble, dealii::SparseMatrix&lt; double &gt; const &amp;R, std::vector&lt; dealii::Vector&lt; double &gt;&gt; const &amp;perturbed_innovation)</td></tr>
<tr class="separator:a405e8d43091eca88e94898eb885313c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb0f621afcc24939d270c2850d9f628e"><td class="memItemLeft" align="right" valign="top">dealii::SparseMatrix&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#aeb0f621afcc24939d270c2850d9f628e">calc_H</a> (dealii::SparsityPattern &amp;pattern) const</td></tr>
<tr class="separator:aeb0f621afcc24939d270c2850d9f628e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e5460783efc1dd7b312927576f1fc86"><td class="memItemLeft" align="right" valign="top">dealii::Vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#a4e5460783efc1dd7b312927576f1fc86">calc_Hx</a> (dealii::LA::distributed::Vector&lt; double &gt; const &amp;sim_ensemble_member) const</td></tr>
<tr class="separator:a4e5460783efc1dd7b312927576f1fc86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78e37ebef7fdc3f7a6f3ec4c2b1b9d13"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#a78e37ebef7fdc3f7a6f3ec4c2b1b9d13">fill_noise_vector</a> (dealii::Vector&lt; double &gt; &amp;vec, dealii::SparseMatrix&lt; double &gt; const &amp;R, bool const R_is_diagonal)</td></tr>
<tr class="separator:a78e37ebef7fdc3f7a6f3ec4c2b1b9d13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f07102e07d3a696e70288048c803977"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#a1f07102e07d3a696e70288048c803977">gaspari_cohn_function</a> (double const r) const</td></tr>
<tr class="separator:a1f07102e07d3a696e70288048c803977"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5bde3f9550c77d9a06d88da422e213e"><td class="memItemLeft" align="right" valign="top">dealii::TrilinosWrappers::SparseMatrix&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#af5bde3f9550c77d9a06d88da422e213e">calc_sample_covariance_sparse</a> (std::vector&lt; dealii::LA::distributed::BlockVector&lt; double &gt;&gt; const &amp;vec_ensemble) const</td></tr>
<tr class="separator:af5bde3f9550c77d9a06d88da422e213e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:aa83bf29573aab1b23211aaeaece2817c"><td class="memItemLeft" align="right" valign="top">MPI_Comm&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#aa83bf29573aab1b23211aaeaece2817c">_global_communicator</a></td></tr>
<tr class="separator:aa83bf29573aab1b23211aaeaece2817c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65cf1d6c324239bf4fac98c1f7abcdc9"><td class="memItemLeft" align="right" valign="top">MPI_Comm&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#a65cf1d6c324239bf4fac98c1f7abcdc9">_local_communicator</a></td></tr>
<tr class="separator:a65cf1d6c324239bf4fac98c1f7abcdc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5420f95c388dec9f638a4f1d4eec1914"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#a5420f95c388dec9f638a4f1d4eec1914">_global_rank</a> = -1</td></tr>
<tr class="separator:a5420f95c388dec9f638a4f1d4eec1914"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1baf2c4af092efb0d076e9071a192d51"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#a1baf2c4af092efb0d076e9071a192d51">_global_comm_size</a> = -1</td></tr>
<tr class="separator:a1baf2c4af092efb0d076e9071a192d51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7e2140d1008357bff83409ab88d0678"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#ab7e2140d1008357bff83409ab88d0678">_color</a> = -1</td></tr>
<tr class="separator:ab7e2140d1008357bff83409ab88d0678"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09166a5bc460fa193e308ddd2c4238dd"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#a09166a5bc460fa193e308ddd2c4238dd">_num_ensemble_members</a> = 0</td></tr>
<tr class="separator:a09166a5bc460fa193e308ddd2c4238dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac440d873ccf340f607f7758de8e7f36"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#aac440d873ccf340f607f7758de8e7f36">_sim_size</a> = 0</td></tr>
<tr class="separator:aac440d873ccf340f607f7758de8e7f36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41a2e76bc1bcf25d0daad9429ab62a30"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#a41a2e76bc1bcf25d0daad9429ab62a30">_parameter_size</a> = 0</td></tr>
<tr class="separator:a41a2e76bc1bcf25d0daad9429ab62a30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e71ae5b0604f35293dbf7e21a8bbf19"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#a9e71ae5b0604f35293dbf7e21a8bbf19">_expt_size</a> = 0</td></tr>
<tr class="separator:a9e71ae5b0604f35293dbf7e21a8bbf19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f8d1cb6edd6a104aedc96dfe8d69eb2"><td class="memItemLeft" align="right" valign="top">dealii::TrilinosWrappers::SparsityPattern&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#a4f8d1cb6edd6a104aedc96dfe8d69eb2">_covariance_sparsity_pattern</a></td></tr>
<tr class="separator:a4f8d1cb6edd6a104aedc96dfe8d69eb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2ac44df9477b567b9c89e4d5f6b34b8"><td class="memItemLeft" align="right" valign="top">std::map&lt; const std::pair&lt; unsigned int, unsigned int &gt;, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#ad2ac44df9477b567b9c89e4d5f6b34b8">_covariance_distance_map</a></td></tr>
<tr class="separator:ad2ac44df9477b567b9c89e4d5f6b34b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a976eb6e98d340fe91837cdd541cd36"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#a8a976eb6e98d340fe91837cdd541cd36">_localization_cutoff_distance</a></td></tr>
<tr class="separator:a8a976eb6e98d340fe91837cdd541cd36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75a7a61d7cf93db94867a0841846c983"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceadamantine.html#ae6f0841ed43262ef1175e2b6075cd66f">LocalizationCutoff</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#a75a7a61d7cf93db94867a0841846c983">_localization_cutoff_function</a></td></tr>
<tr class="separator:a75a7a61d7cf93db94867a0841846c983"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45530f547f2a1026d89ca4ee12fd6568"><td class="memItemLeft" align="right" valign="top">std::mt19937&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#a45530f547f2a1026d89ca4ee12fd6568">_prng</a></td></tr>
<tr class="separator:a45530f547f2a1026d89ca4ee12fd6568"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b01fc9c69e311682856ad2e12c8d0d0"><td class="memItemLeft" align="right" valign="top">std::normal_distribution&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#a9b01fc9c69e311682856ad2e12c8d0d0">_normal_dist_generator</a></td></tr>
<tr class="separator:a9b01fc9c69e311682856ad2e12c8d0d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8632b9b6a961a26cfa91ede3cd67f60"><td class="memItemLeft" align="right" valign="top">std::pair&lt; std::vector&lt; int &gt;, std::vector&lt; int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#ae8632b9b6a961a26cfa91ede3cd67f60">_expt_to_dof_mapping</a></td></tr>
<tr class="separator:ae8632b9b6a961a26cfa91ede3cd67f60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3a8ea4992368e7fa15b538ef05ab243"><td class="memItemLeft" align="right" valign="top">dealii::SolverControl&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#aa3a8ea4992368e7fa15b538ef05ab243">_solver_control</a></td></tr>
<tr class="separator:aa3a8ea4992368e7fa15b538ef05ab243"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef8723a176e59a627727bffa0397d399"><td class="memItemLeft" align="right" valign="top">dealii::SolverGMRES&lt; dealii::Vector&lt; double &gt; &gt;::AdditionalData&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#aef8723a176e59a627727bffa0397d399">_additional_data</a></td></tr>
<tr class="separator:aef8723a176e59a627727bffa0397d399"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a96b4f642ed949291708e58912aa03992"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classadamantine_1_1_data_assimilator.html#a96b4f642ed949291708e58912aa03992">DataAssimilatorTester</a></td></tr>
<tr class="separator:a96b4f642ed949291708e58912aa03992"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class implements an ensemble Kalman filter (EnKF) for data assimilation. It updates an ensemble of solution vectors to be consistent with experimental observations.</p>
<p>The EnKF implementation here is largely based on Chapter 6 of Data Assimilation: Method and Applications by Asch, Bocquet, and Nodet. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8hh_source.html#l00058">58</a> of file <a class="el" href="_data_assimilator_8hh_source.html">DataAssimilator.hh</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="aa0515b812dcfc0c4c14789d6c7cd0b4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0515b812dcfc0c4c14789d6c7cd0b4c">&#9670;&nbsp;</a></span>block_size_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classadamantine_1_1_data_assimilator.html#aa0515b812dcfc0c4c14789d6c7cd0b4c">adamantine::DataAssimilator::block_size_type</a> =  dealii::LA::distributed::BlockVector&lt;double&gt;::size_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8hh_source.html#l00111">111</a> of file <a class="el" href="_data_assimilator_8hh_source.html">DataAssimilator.hh</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a9aca6e1413a227d29e89faa45a8006f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9aca6e1413a227d29e89faa45a8006f0">&#9670;&nbsp;</a></span>DataAssimilator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">adamantine::DataAssimilator::DataAssimilator </td>
          <td>(</td>
          <td class="paramtype">MPI_Comm const &amp;&#160;</td>
          <td class="paramname"><em>global_communicator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm const &amp;&#160;</td>
          <td class="paramname"><em>local_communicator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>my_color</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boost::property_tree::ptree const &amp;&#160;</td>
          <td class="paramname"><em>database</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8cc_source.html#l00031">31</a> of file <a class="el" href="_data_assimilator_8cc_source.html">DataAssimilator.cc</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a405e8d43091eca88e94898eb885313c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a405e8d43091eca88e94898eb885313c3">&#9670;&nbsp;</a></span>apply_kalman_gain()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; dealii::LA::distributed::BlockVector&lt; double &gt; &gt; adamantine::DataAssimilator::apply_kalman_gain </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; dealii::LA::distributed::BlockVector&lt; double &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>augmented_state_ensemble</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dealii::SparseMatrix&lt; double &gt; const &amp;&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; dealii::Vector&lt; double &gt;&gt; const &amp;&#160;</td>
          <td class="paramname"><em>perturbed_innovation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This calculates the Kalman gain and applies it to the perturbed innovation. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8cc_source.html#l00400">400</a> of file <a class="el" href="_data_assimilator_8cc_source.html">DataAssimilator.cc</a>.</p>

</div>
</div>
<a id="aeb0f621afcc24939d270c2850d9f628e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb0f621afcc24939d270c2850d9f628e">&#9670;&nbsp;</a></span>calc_H()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">dealii::SparseMatrix&lt; double &gt; adamantine::DataAssimilator::calc_H </td>
          <td>(</td>
          <td class="paramtype">dealii::SparsityPattern &amp;&#160;</td>
          <td class="paramname"><em>pattern</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This calculates the observation matrix. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8cc_source.html#l00475">475</a> of file <a class="el" href="_data_assimilator_8cc_source.html">DataAssimilator.cc</a>.</p>

</div>
</div>
<a id="a4e5460783efc1dd7b312927576f1fc86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e5460783efc1dd7b312927576f1fc86">&#9670;&nbsp;</a></span>calc_Hx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">dealii::Vector&lt; double &gt; adamantine::DataAssimilator::calc_Hx </td>
          <td>(</td>
          <td class="paramtype">dealii::LA::distributed::Vector&lt; double &gt; const &amp;&#160;</td>
          <td class="paramname"><em>sim_ensemble_member</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This calculates the application of the observation matrix on an unaugmented ensemble member from the simulation, avoiding explicit construction of a sparse matrix for H. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8cc_source.html#l00608">608</a> of file <a class="el" href="_data_assimilator_8cc_source.html">DataAssimilator.cc</a>.</p>

</div>
</div>
<a id="af5bde3f9550c77d9a06d88da422e213e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5bde3f9550c77d9a06d88da422e213e">&#9670;&nbsp;</a></span>calc_sample_covariance_sparse()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">dealii::TrilinosWrappers::SparseMatrix adamantine::DataAssimilator::calc_sample_covariance_sparse </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; dealii::LA::distributed::BlockVector&lt; double &gt;&gt; const &amp;&#160;</td>
          <td class="paramname"><em>vec_ensemble</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This calculates the sample covariance for an input ensemble of vectors (vec_ensemble). Currently this is tied to the simulation ensemble, through the use of member variables inside. If needed, the interface could be redone to make it more generally applicable. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8cc_source.html#l00685">685</a> of file <a class="el" href="_data_assimilator_8cc_source.html">DataAssimilator.cc</a>.</p>

</div>
</div>
<a id="a78e37ebef7fdc3f7a6f3ec4c2b1b9d13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78e37ebef7fdc3f7a6f3ec4c2b1b9d13">&#9670;&nbsp;</a></span>fill_noise_vector()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void adamantine::DataAssimilator::fill_noise_vector </td>
          <td>(</td>
          <td class="paramtype">dealii::Vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dealii::SparseMatrix&lt; double &gt; const &amp;&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool const&#160;</td>
          <td class="paramname"><em>R_is_diagonal</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This fills a vector (vec) with noise from a multivariate normal distribution defined by a covariance matrix (R). Note: For non-diagonal R this method currently uses full matrices, which substantially limits the allowable problem size. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8cc_source.html#l00624">624</a> of file <a class="el" href="_data_assimilator_8cc_source.html">DataAssimilator.cc</a>.</p>

</div>
</div>
<a id="a1f07102e07d3a696e70288048c803977"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f07102e07d3a696e70288048c803977">&#9670;&nbsp;</a></span>gaspari_cohn_function()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double adamantine::DataAssimilator::gaspari_cohn_function </td>
          <td>(</td>
          <td class="paramtype">double const&#160;</td>
          <td class="paramname"><em>r</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A standard localization function, resembles a Gaussian, but with finite support. From Gaspari and Cohn, Quarterly Journal of the Royal Meteorological Society, 125, 1999. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8cc_source.html#l00666">666</a> of file <a class="el" href="_data_assimilator_8cc_source.html">DataAssimilator.cc</a>.</p>

</div>
</div>
<a id="a85dc10ab67036ce6c85429dd1cf2fce9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85dc10ab67036ce6c85429dd1cf2fce9">&#9670;&nbsp;</a></span>gather_ensemble_members()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void adamantine::DataAssimilator::gather_ensemble_members </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; dealii::LA::distributed::BlockVector&lt; double &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>augmented_state_ensemble</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; dealii::LA::distributed::BlockVector&lt; double &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>global_augmented_state_ensemble</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>local_n_ensemble_members</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classadamantine_1_1_data_assimilator.html#aa0515b812dcfc0c4c14789d6c7cd0b4c">block_size_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>block_sizes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Gather the augmented ensemble members on the global root node in order to apply the Kalman gain. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8cc_source.html#l00187">187</a> of file <a class="el" href="_data_assimilator_8cc_source.html">DataAssimilator.cc</a>.</p>

</div>
</div>
<a id="ac27d0c63d7e8b2a70bd29d29e6ae8a10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac27d0c63d7e8b2a70bd29d29e6ae8a10">&#9670;&nbsp;</a></span>scatter_ensemble_members()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void adamantine::DataAssimilator::scatter_ensemble_members </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; dealii::LA::distributed::BlockVector&lt; double &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>augmented_state_ensemble</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; dealii::LA::distributed::BlockVector&lt; double &gt;&gt; const &amp;&#160;</td>
          <td class="paramname"><em>global_augmented_state_ensemble</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; unsigned int &gt; const &amp;&#160;</td>
          <td class="paramname"><em>local_n_ensemble_members</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classadamantine_1_1_data_assimilator.html#aa0515b812dcfc0c4c14789d6c7cd0b4c">block_size_type</a> &gt; const &amp;&#160;</td>
          <td class="paramname"><em>block_sizes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Scatter the <code>global_augmented_state_ensemble</code> back into <code>augmented_state_ensemble</code>. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8cc_source.html#l00301">301</a> of file <a class="el" href="_data_assimilator_8cc_source.html">DataAssimilator.cc</a>.</p>

</div>
</div>
<a id="aa589f4a2068eddc12fbb1408ffec04b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa589f4a2068eddc12fbb1408ffec04b7">&#9670;&nbsp;</a></span>update_covariance_sparsity_pattern()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">template void adamantine::DataAssimilator::update_covariance_sparsity_pattern&lt; 3 &gt; </td>
          <td>(</td>
          <td class="paramtype">dealii::DoFHandler&lt; dim &gt; const &amp;&#160;</td>
          <td class="paramname"><em>dof_handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>parameter_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This updates the sparsity pattern for the sample covariance matrix for the simulation ensemble. This must be called before updateEnsemble whenever there are changes to the simulation mesh. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8cc_source.html#l00509">509</a> of file <a class="el" href="_data_assimilator_8cc_source.html">DataAssimilator.cc</a>.</p>

</div>
</div>
<a id="a6c09078d680adc5d2a791a570bb5a7ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c09078d680adc5d2a791a570bb5a7ac">&#9670;&nbsp;</a></span>update_dof_mapping()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">template void adamantine::DataAssimilator::update_dof_mapping&lt; 3 &gt; </td>
          <td>(</td>
          <td class="paramtype">std::pair&lt; std::vector&lt; int &gt;, std::vector&lt; int &gt;&gt; const &amp;&#160;</td>
          <td class="paramname"><em>expt_to_dof_mapping</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This updates the internal mapping between the indices of the entries in expt_data and the indices of the entries in the sim_data ensemble members in updateEnsemble. This must be called before updateEnsemble whenever there are changes to the simulation mesh or the observation locations. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8cc_source.html#l00501">501</a> of file <a class="el" href="_data_assimilator_8cc_source.html">DataAssimilator.cc</a>.</p>

</div>
</div>
<a id="ab90c04d7eb24c9202e84409109146143"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab90c04d7eb24c9202e84409109146143">&#9670;&nbsp;</a></span>update_ensemble()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void adamantine::DataAssimilator::update_ensemble </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; dealii::LA::distributed::BlockVector&lt; double &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>augmented_state_ensemble</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; const &amp;&#160;</td>
          <td class="paramname"><em>expt_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dealii::SparseMatrix&lt; double &gt; const &amp;&#160;</td>
          <td class="paramname"><em>R</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is the main public interface for the class and is called to perform one assimilation process. It takes in an ensemble of simulation data (sim_data), experimental observation data (expt_data), and the covariance matrix for the experimental observations (R). This function updates sim_data using the EnKF method.</p>
<p>Overall it performs x = x + K (y + u - H x) for each ensemble member, where: x is the simulation solution K is the Kalman gain y is the observed solution u is a perturbation to the observed solution H is the observation matrix </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8cc_source.html#l00091">91</a> of file <a class="el" href="_data_assimilator_8cc_source.html">DataAssimilator.cc</a>.</p>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a id="a96b4f642ed949291708e58912aa03992"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96b4f642ed949291708e58912aa03992">&#9670;&nbsp;</a></span>DataAssimilatorTester</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class DataAssimilatorTester</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8hh_source.html#l00060">60</a> of file <a class="el" href="_data_assimilator_8hh_source.html">DataAssimilator.hh</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="aef8723a176e59a627727bffa0397d399"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef8723a176e59a627727bffa0397d399">&#9670;&nbsp;</a></span>_additional_data</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">dealii::SolverGMRES&lt;dealii::Vector&lt;double&gt; &gt;::AdditionalData adamantine::DataAssimilator::_additional_data</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Additional settings for the GMRES solver needed for the matrix inversion in the Kalman gain calculation. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8hh_source.html#l00287">287</a> of file <a class="el" href="_data_assimilator_8hh_source.html">DataAssimilator.hh</a>.</p>

</div>
</div>
<a id="ab7e2140d1008357bff83409ab88d0678"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7e2140d1008357bff83409ab88d0678">&#9670;&nbsp;</a></span>_color</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int adamantine::DataAssimilator::_color = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Color associated with the local </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8hh_source.html#l00210">210</a> of file <a class="el" href="_data_assimilator_8hh_source.html">DataAssimilator.hh</a>.</p>

</div>
</div>
<a id="ad2ac44df9477b567b9c89e4d5f6b34b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2ac44df9477b567b9c89e4d5f6b34b8">&#9670;&nbsp;</a></span>_covariance_distance_map</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;const std::pair&lt;unsigned int, unsigned int&gt;, double&gt; adamantine::DataAssimilator::_covariance_distance_map</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Map between the indices in the covariance matrix and the distance between the support points for the associated dofs on the mesh. This is necessary for localization. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8hh_source.html#l00243">243</a> of file <a class="el" href="_data_assimilator_8hh_source.html">DataAssimilator.hh</a>.</p>

</div>
</div>
<a id="a4f8d1cb6edd6a104aedc96dfe8d69eb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f8d1cb6edd6a104aedc96dfe8d69eb2">&#9670;&nbsp;</a></span>_covariance_sparsity_pattern</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">dealii::TrilinosWrappers::SparsityPattern adamantine::DataAssimilator::_covariance_sparsity_pattern</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The sparsity pattern for the localized covariance matrix. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8hh_source.html#l00235">235</a> of file <a class="el" href="_data_assimilator_8hh_source.html">DataAssimilator.hh</a>.</p>

</div>
</div>
<a id="a9e71ae5b0604f35293dbf7e21a8bbf19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e71ae5b0604f35293dbf7e21a8bbf19">&#9670;&nbsp;</a></span>_expt_size</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int adamantine::DataAssimilator::_expt_size = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The length of the data vector the experimental observations. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8hh_source.html#l00230">230</a> of file <a class="el" href="_data_assimilator_8hh_source.html">DataAssimilator.hh</a>.</p>

</div>
</div>
<a id="ae8632b9b6a961a26cfa91ede3cd67f60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8632b9b6a961a26cfa91ede3cd67f60">&#9670;&nbsp;</a></span>_expt_to_dof_mapping</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt;std::vector&lt;int&gt;, std::vector&lt;int&gt; &gt; adamantine::DataAssimilator::_expt_to_dof_mapping</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The mapping between the index in the experimental observation data vector to the DoF in the simulation data vectors. This is simpler to use than the indices and offsets that are passed into updateEnsemble, and means that the simulation DoFHandler only needs to be used by updateDofMapping where this variable is set. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8hh_source.html#l00275">275</a> of file <a class="el" href="_data_assimilator_8hh_source.html">DataAssimilator.hh</a>.</p>

</div>
</div>
<a id="a1baf2c4af092efb0d076e9071a192d51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1baf2c4af092efb0d076e9071a192d51">&#9670;&nbsp;</a></span>_global_comm_size</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int adamantine::DataAssimilator::_global_comm_size = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Number of processes in the gglbal MPI communicator. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8hh_source.html#l00205">205</a> of file <a class="el" href="_data_assimilator_8hh_source.html">DataAssimilator.hh</a>.</p>

</div>
</div>
<a id="aa83bf29573aab1b23211aaeaece2817c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa83bf29573aab1b23211aaeaece2817c">&#9670;&nbsp;</a></span>_global_communicator</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Comm adamantine::DataAssimilator::_global_communicator</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Global MPI communicator. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8hh_source.html#l00190">190</a> of file <a class="el" href="_data_assimilator_8hh_source.html">DataAssimilator.hh</a>.</p>

</div>
</div>
<a id="a5420f95c388dec9f638a4f1d4eec1914"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5420f95c388dec9f638a4f1d4eec1914">&#9670;&nbsp;</a></span>_global_rank</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int adamantine::DataAssimilator::_global_rank = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Rank of the process when using the global MPI communicator. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8hh_source.html#l00200">200</a> of file <a class="el" href="_data_assimilator_8hh_source.html">DataAssimilator.hh</a>.</p>

</div>
</div>
<a id="a65cf1d6c324239bf4fac98c1f7abcdc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65cf1d6c324239bf4fac98c1f7abcdc9">&#9670;&nbsp;</a></span>_local_communicator</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Comm adamantine::DataAssimilator::_local_communicator</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Local MPI communicator split off the global MPI communicator. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8hh_source.html#l00195">195</a> of file <a class="el" href="_data_assimilator_8hh_source.html">DataAssimilator.hh</a>.</p>

</div>
</div>
<a id="a8a976eb6e98d340fe91837cdd541cd36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a976eb6e98d340fe91837cdd541cd36">&#9670;&nbsp;</a></span>_localization_cutoff_distance</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double adamantine::DataAssimilator::_localization_cutoff_distance</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The distance at which the sample covariance is truncated. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8hh_source.html#l00248">248</a> of file <a class="el" href="_data_assimilator_8hh_source.html">DataAssimilator.hh</a>.</p>

</div>
</div>
<a id="a75a7a61d7cf93db94867a0841846c983"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75a7a61d7cf93db94867a0841846c983">&#9670;&nbsp;</a></span>_localization_cutoff_function</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceadamantine.html#ae6f0841ed43262ef1175e2b6075cd66f">LocalizationCutoff</a> adamantine::DataAssimilator::_localization_cutoff_function</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The function used to reduce the sample covariance entries based on the distance between the relevant points. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8hh_source.html#l00254">254</a> of file <a class="el" href="_data_assimilator_8hh_source.html">DataAssimilator.hh</a>.</p>

</div>
</div>
<a id="a9b01fc9c69e311682856ad2e12c8d0d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b01fc9c69e311682856ad2e12c8d0d0">&#9670;&nbsp;</a></span>_normal_dist_generator</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::normal_distribution adamantine::DataAssimilator::_normal_dist_generator</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Random variate generator for a normal distribution, used for the perturbations to the innovation vectors. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8hh_source.html#l00266">266</a> of file <a class="el" href="_data_assimilator_8hh_source.html">DataAssimilator.hh</a>.</p>

</div>
</div>
<a id="a09166a5bc460fa193e308ddd2c4238dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09166a5bc460fa193e308ddd2c4238dd">&#9670;&nbsp;</a></span>_num_ensemble_members</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int adamantine::DataAssimilator::_num_ensemble_members = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The number of ensemble members in the simulation. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8hh_source.html#l00215">215</a> of file <a class="el" href="_data_assimilator_8hh_source.html">DataAssimilator.hh</a>.</p>

</div>
</div>
<a id="a41a2e76bc1bcf25d0daad9429ab62a30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41a2e76bc1bcf25d0daad9429ab62a30">&#9670;&nbsp;</a></span>_parameter_size</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int adamantine::DataAssimilator::_parameter_size = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The length of the parameter vector for each simulation ensemble member. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8hh_source.html#l00225">225</a> of file <a class="el" href="_data_assimilator_8hh_source.html">DataAssimilator.hh</a>.</p>

</div>
</div>
<a id="a45530f547f2a1026d89ca4ee12fd6568"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45530f547f2a1026d89ca4ee12fd6568">&#9670;&nbsp;</a></span>_prng</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::mt19937 adamantine::DataAssimilator::_prng</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The pseudo-random number generator, used for the perturbations to the innovation vectors. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8hh_source.html#l00260">260</a> of file <a class="el" href="_data_assimilator_8hh_source.html">DataAssimilator.hh</a>.</p>

</div>
</div>
<a id="aac440d873ccf340f607f7758de8e7f36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac440d873ccf340f607f7758de8e7f36">&#9670;&nbsp;</a></span>_sim_size</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int adamantine::DataAssimilator::_sim_size = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The length of the data vector for each simulation ensemble member. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8hh_source.html#l00220">220</a> of file <a class="el" href="_data_assimilator_8hh_source.html">DataAssimilator.hh</a>.</p>

</div>
</div>
<a id="aa3a8ea4992368e7fa15b538ef05ab243"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3a8ea4992368e7fa15b538ef05ab243">&#9670;&nbsp;</a></span>_solver_control</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">dealii::SolverControl adamantine::DataAssimilator::_solver_control</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Standardized settings for the GMRES solver needed for the matrix inversion in the Kalman gain calculation. </p>

<p class="definition">Definition at line <a class="el" href="_data_assimilator_8hh_source.html#l00281">281</a> of file <a class="el" href="_data_assimilator_8hh_source.html">DataAssimilator.hh</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
